'use client'
"use strict";var l=Object.create;var u=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var f=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var b=(t,e)=>{for(var r in e)u(t,r,{get:e[r],enumerable:!0})},m=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of x(e))!h.call(t,n)&&n!==r&&u(t,n,{get:()=>e[n],enumerable:!(o=p(e,n))||o.enumerable});return t};var T=(t,e,r)=>(r=t!=null?l(f(t)):{},m(e||!t||!t.__esModule?u(r,"default",{value:t,enumerable:!0}):r,t)),L=t=>m(u({},"__esModule",{value:!0}),t);var O={};b(O,{Mathematics:()=>y});module.exports=L(O);var c=require("@tiptap/core"),A=require("@tiptap/pm/state"),d=T(require("katex"),1),y=c.Node.create({name:"math",inline:!0,group:"inline",atom:!0,selectable:!0,marks:"",addAttributes(){return{latex:""}},addOptions(){return{shouldRender:(t,e)=>{let r=t.doc.resolve(e);return r.parent.isTextblock?r.parent.type.name!=="codeBlock":!1},katexOptions:{throwOnError:!1},HTMLAttributes:{}}},addCommands(){return{setLatex:({latex:t})=>({chain:e,state:r})=>{if(!t)return!1;let{from:o,to:n,$anchor:a}=r.selection;return this.options.shouldRender(r,a.pos)?e().insertContentAt({from:o,to:n},{type:"math",attrs:{latex:t}}).setTextSelection({from:o,to:o+1}).run():!1},unsetLatex:()=>({editor:t,state:e,chain:r})=>{let o=t.getAttributes(this.name).latex;if(typeof o!="string")return!1;let{from:n,to:a}=e.selection;return r().command(({tr:s})=>(s.insertText(o,n,a),!0)).setTextSelection({from:n,to:n+o.length}).run()}}},parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({node:t,HTMLAttributes:e}){let r=t.attrs.latex??"";return["span",(0,c.mergeAttributes)(e,{"data-type":this.name}),r]},renderText({node:t}){return t.attrs.latex??""},addNodeView(){return({node:t,HTMLAttributes:e,getPos:r,editor:o})=>{let n=document.createElement("span"),a=t.attrs.latex??"";return Object.entries(this.options.HTMLAttributes).forEach(([s,i])=>{n.setAttribute(s,i)}),Object.entries(e).forEach(([s,i])=>{n.setAttribute(s,i)}),n.addEventListener("click",()=>{if(o.isEditable&&typeof r=="function"){let s=r(),i=t.nodeSize;o.commands.setTextSelection({from:s,to:s+i})}}),n.contentEditable="false",n.innerHTML=d.default.renderToString(a,this.options.katexOptions),{dom:n}}}});0&&(module.exports={Mathematics});
