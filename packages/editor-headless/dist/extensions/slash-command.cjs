'use client'
"use strict";var O=Object.create;var p=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var A=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty;var T=(e,t)=>{for(var o in t)p(e,o,{get:t[o],enumerable:!0})},g=(e,t,o,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of P(t))!I.call(e,r)&&r!==o&&p(e,r,{get:()=>t[r],enumerable:!(n=k(t,r))||n.enumerable});return e};var C=(e,t,o)=>(o=e!=null?O(A(e)):{},g(t||!e||!e.__esModule?p(o,"default",{value:e,enumerable:!0}):o,e)),D=e=>g(p({},"__esModule",{value:!0}),e);var U={};T(U,{Command:()=>N,createSuggestionItems:()=>L,handleCommandNavigation:()=>M,renderItems:()=>q});module.exports=D(U);var w=require("@tiptap/core"),x=require("@tiptap/react"),b=C(require("@tiptap/suggestion"),1),S=C(require("tippy.js"),1);var u=require("cmdk"),c=require("jotai"),m=require("react");var l=require("jotai"),y=(0,l.atom)(""),R=(0,l.atom)(null);var E=require("jotai"),f=(0,E.createStore)();var a=require("react/jsx-runtime"),v=(0,m.createContext)({}),h=({query:e,range:t})=>{let o=(0,c.useSetAtom)(y,{store:f}),n=(0,c.useSetAtom)(R,{store:f});return(0,m.useEffect)(()=>{o(e)},[e,o]),(0,m.useEffect)(()=>{n(t)},[t,n]),(0,m.useEffect)(()=>{let r=["ArrowUp","ArrowDown","Enter"],s=i=>{if(r.includes(i.key)){i.preventDefault();let d=document.querySelector("#slash-command");return d&&d.dispatchEvent(new KeyboardEvent("keydown",{key:i.key,cancelable:!0,bubbles:!0})),!1}};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}},[]),(0,a.jsx)(v.Consumer,{children:r=>(0,a.jsx)(r.Out,{})})},K=(0,m.forwardRef)(({children:e,className:t,...o},n)=>{let[r,s]=(0,c.useAtom)(y);return(0,a.jsx)(v.Consumer,{children:i=>(0,a.jsx)(i.In,{children:(0,a.jsxs)(u.Command,{ref:n,onKeyDown:d=>{d.stopPropagation()},id:"slash-command",className:t,...o,children:[(0,a.jsx)(u.Command.Input,{value:r,onValueChange:s,style:{display:"none"}}),e]})})})}),j=u.Command.List;K.displayName="EditorCommand";var N=w.Extension.create({name:"slash-command",addOptions(){return{suggestion:{char:"/",command:({editor:e,range:t,props:o})=>{o.command({editor:e,range:t})}}}},addProseMirrorPlugins(){return[(0,b.default)({editor:this.editor,...this.options.suggestion})]}}),q=e=>{let t=null,o=null;return{onStart:n=>{t=new x.ReactRenderer(h,{props:n,editor:n.editor});let{selection:r}=n.editor.state;if(r.$from.node(r.$from.depth).type.name==="codeBlock")return!1;o=(0,S.default)("body",{getReferenceClientRect:n.clientRect,appendTo:()=>e?e.current:document.body,content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"})},onUpdate:n=>{t?.updateProps(n),o?.[0]?.setProps({getReferenceClientRect:n.clientRect})},onKeyDown:n=>n.event.key==="Escape"?(o?.[0]?.hide(),!0):t?.ref?.onKeyDown(n),onExit:()=>{o?.[0]?.destroy(),t?.destroy()}}},L=e=>e,M=e=>{if(["ArrowUp","ArrowDown","Enter"].includes(e.key)&&document.querySelector("#slash-command"))return!0};0&&(module.exports={Command,createSuggestionItems,handleCommandNavigation,renderItems});
